{"ast":null,"code":"import _regeneratorRuntime from \"/home/jackson/Desktop/crm-ticket/crm-ticket/CrmFrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/jackson/Desktop/crm-ticket/crm-ticket/CrmFrontEnd/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _this = this,\n  _jsxFileName = \"/home/jackson/Desktop/crm-ticket/crm-ticket/CrmFrontEnd/src/component/privaterouter/PrivateRoute.comp.js\";\nimport React, { useEffect } from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport { Navigate, Outlet } from \"react-router-dom\";\nimport { DefaultLayout } from '../../Layout/Default.Layout';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { getUserProfile } from '../../page/dashboard/userAction';\nimport { fetchNewAccessJWT } from '../../api/userApi';\nimport { loginSuccess } from '../../component/login/loginSlice';\nvar PrivateRoute = function PrivateRoute() {\n  var dispatch = useDispatch();\n  var _useSelector = useSelector(function (state) {\n      return state.login;\n    }),\n    isAuth = _useSelector.isAuth;\n  var _useSelector2 = useSelector(function (state) {\n      return state.user;\n    }),\n    user = _useSelector2.user;\n  useEffect(function () {\n    var updateAccessJWT = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var result;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetchNewAccessJWT;\n              case 2:\n                result = _context.sent;\n                result && dispatch(loginSuccess());\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return function updateAccessJWT() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    !user.id && dispatch(getUserProfile());\n    !sessionStorage.getItem(\"accessJWT\") && localStorage.getItem(\"crmSite\") && updateAccessJWT();\n    !isAuth && sessionStorage.getItem('accessJWT') && dispatch(loginSuccess());\n  }, [isAuth, dispatch, user.id]);\n  return isAuth ? /*#__PURE__*/React.createElement(Outlet, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 15\n    }\n  }) : /*#__PURE__*/React.createElement(Navigate, {\n    to: \"/\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 39,\n      columnNumber: 27\n    }\n  });\n};\nexport default PrivateRoute;","map":{"version":3,"names":["React","useEffect","Routes","Route","Navigate","Outlet","DefaultLayout","useDispatch","useSelector","getUserProfile","fetchNewAccessJWT","loginSuccess","PrivateRoute","dispatch","state","login","isAuth","user","updateAccessJWT","result","id","sessionStorage","getItem","localStorage"],"sources":["/home/jackson/Desktop/crm-ticket/crm-ticket/CrmFrontEnd/src/component/privaterouter/PrivateRoute.comp.js"],"sourcesContent":["import React, { useEffect } from 'react'\nimport { Routes ,Route} from 'react-router-dom'\nimport { Navigate,Outlet } from \"react-router-dom\";\nimport { DefaultLayout } from '../../Layout/Default.Layout';\nimport { useDispatch, useSelector } from 'react-redux';\nimport {getUserProfile} from '../../page/dashboard/userAction'\n\nimport {fetchNewAccessJWT} from '../../api/userApi'\n\nimport  {loginSuccess} from '../../component/login/loginSlice'\n\nconst PrivateRoute = () => {\n const dispatch =useDispatch()\n\n  const {isAuth}=useSelector(state=>state.login)\n  const {user}=useSelector(state=>state.user)\n\n   useEffect(() => {\n    const updateAccessJWT = async () => {\n\t\t\tconst result = await fetchNewAccessJWT;\n\t\t\tresult && dispatch(loginSuccess());\n\t\t};\n\n    \n     \n   !user.id && dispatch(getUserProfile())\n\t\t!sessionStorage.getItem(\"accessJWT\") &&localStorage.getItem(\"crmSite\") &&updateAccessJWT();\n\n    !isAuth&&sessionStorage.getItem('accessJWT') && dispatch(loginSuccess())\n    \n   }, [isAuth,dispatch,user.id])\n   \n\n\n\n\n  return (\n \n    isAuth ?  <Outlet/> : <Navigate to=\"/\" /> \n      \n    \n\n\n\n\n  )\n}\n\nexport default PrivateRoute"],"mappings":";;;;AAAA,OAAOA,KAAK,IAAIC,SAAS,QAAQ,OAAO;AACxC,SAASC,MAAM,EAAEC,KAAK,QAAO,kBAAkB;AAC/C,SAASC,QAAQ,EAACC,MAAM,QAAQ,kBAAkB;AAClD,SAASC,aAAa,QAAQ,6BAA6B;AAC3D,SAASC,WAAW,EAAEC,WAAW,QAAQ,aAAa;AACtD,SAAQC,cAAc,QAAO,iCAAiC;AAE9D,SAAQC,iBAAiB,QAAO,mBAAmB;AAEnD,SAASC,YAAY,QAAO,kCAAkC;AAE9D,IAAMC,YAAY,GAAG,SAAfA,YAAY,GAAS;EAC1B,IAAMC,QAAQ,GAAEN,WAAW,EAAE;EAAA,mBAEbC,WAAW,CAAC,UAAAM,KAAK;MAAA,OAAEA,KAAK,CAACC,KAAK;IAAA,EAAC;IAAvCC,MAAM,gBAANA,MAAM;EAAA,oBACAR,WAAW,CAAC,UAAAM,KAAK;MAAA,OAAEA,KAAK,CAACG,IAAI;IAAA,EAAC;IAApCA,IAAI,iBAAJA,IAAI;EAEVhB,SAAS,CAAC,YAAM;IACf,IAAMiB,eAAe;MAAA,oEAAG;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA,OACJR,iBAAiB;cAAA;gBAAhCS,MAAM;gBACZA,MAAM,IAAIN,QAAQ,CAACF,YAAY,EAAE,CAAC;cAAC;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CACnC;MAAA,gBAHOO,eAAe;QAAA;MAAA;IAAA,GAGtB;IAIA,CAACD,IAAI,CAACG,EAAE,IAAIP,QAAQ,CAACJ,cAAc,EAAE,CAAC;IACvC,CAACY,cAAc,CAACC,OAAO,CAAC,WAAW,CAAC,IAAGC,YAAY,CAACD,OAAO,CAAC,SAAS,CAAC,IAAGJ,eAAe,EAAE;IAExF,CAACF,MAAM,IAAEK,cAAc,CAACC,OAAO,CAAC,WAAW,CAAC,IAAIT,QAAQ,CAACF,YAAY,EAAE,CAAC;EAEzE,CAAC,EAAE,CAACK,MAAM,EAACH,QAAQ,EAACI,IAAI,CAACG,EAAE,CAAC,CAAC;EAM9B,OAEEJ,MAAM,gBAAI,oBAAC,MAAM;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EAAE,gBAAG,oBAAC,QAAQ;IAAC,EAAE,EAAC,GAAG;IAAA;IAAA;MAAA;MAAA;MAAA;IAAA;EAAA,EAAG;AAQ7C,CAAC;AAED,eAAeJ,YAAY"},"metadata":{},"sourceType":"module"}